{"ast":null,"code":"import _objectSpread from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";//import { useHistory } from \"react-router-dom\";\nimport{Button,TextField}from\"@material-ui/core\";import{makeStyles}from\"@material-ui/core/styles\";import{useCustomToast}from\"../helpers/useCustomToast\";import{useEmployees}from\"./employees/useEmployees\";import{useRecoilState}from\"recoil\";import{loginLevelState}from\"./data/atomdata\";import{useEmployeesContext}from\"../context/employees_context\";//import { setStoredUser } from \"./user-storage\";\n//import { useAuthContext } from \"../context/auth_context\";\nimport App from\"../utils/firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SigninForm=function SigninForm(){//let history = useHistory();\nvar classes=useStyles();var toast=useCustomToast();//const { currentUser } = useAuthContext();\nvar _useEmployees=useEmployees(),employees=_useEmployees.employees;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),role=_useState6[0],setRole=_useState6[1];var _useRecoilState=useRecoilState(loginLevelState),_useRecoilState2=_slicedToArray(_useRecoilState,2),loginLevel=_useRecoilState2[0],setLoginLevel=_useRecoilState2[1];var _useEmployeesContext=useEmployeesContext(),setEditEmployeeID=_useEmployeesContext.setEditEmployeeID;var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();//console.log(\"sigin\", email, password);\n//const { email, password } = event.target.elements;\n_context.prev=1;_context.next=4;return App.auth().signInWithEmailAndPassword(email,password);case 4://history.pushState(\"/\");\nupdate_login();_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);toast({title:\"Invalid email or password!\",status:\"warning\"});case 10:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();var update_login=function update_login(){var emp=employees.filter(function(item){return item.email===email;}).map(function(row){return{id:row.id,name:row.name,email:row.email,password:row.password,role:role,leave_bal:row.leave_bal,siteallows_fee:row.siteallows_fee,perdiem_fee:row.perdiem_fee,reporting_to:row.reporting_to};});if(!emp.length){toast({title:\"Invalid email!\",status:\"warning\"});}else{setLoginLevel(_objectSpread(_objectSpread({},loginLevel),{},{loginUser:emp[0].name,loginUserId:emp[0].id,loginLevel:role,loginEmail:email,login:true,leave_bal:emp[0].leave_bal,siteallows_fee:emp[0].siteallows_fee,perdiem_fee:emp[0].perdiem_fee,reporting_to:emp[0].reporting_to}));setEditEmployeeID(emp[0].id);setPassword(\"\");//setStoredUser(emp[0]);\n}};// const handleStaffClick = (e) => {\n//   console.log(\"Staff\");\n//   e.preventDefault();\n//   setRole(\"Staff\");\n//   handleSubmit(e);\n// };\n// const handleAdminClick = (e) => {\n//   e.preventDefault();\n//   setRole(\"Admin\");\n//   handleSubmit(e);\n// };\n// const handleAdminManagerClick = (e) => {\n//   e.preventDefault();\n//   setRole(\"AdminManager\");\n//   handleSubmit(e);\n// };\n// const handleManagerClick = (e) => {\n//   e.preventDefault();\n//   setRole(\"Manager\");\n//   // handleSubmit(e);\n// };\nreturn/*#__PURE__*/_jsxs(\"form\",{className:classes.root,onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\"},children:[/*#__PURE__*/_jsx(TextField,{label:\"Email\",variant:\"filled\",type:\"email\",required:true,style:{width:350},value:email,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{label:\"Password\",variant:\"filled\",type:\"password\",style:{width:350},required:true,value:password,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\"},children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"Staff\");},children:\"Staff\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"Admin\");},children:\"Admin\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"AdminManager\");},children:\"Admin Manager\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"Manager\");},children:\"Manager\"})]})]});};var useStyles=makeStyles(function(theme){return{root:{display:\"flex\",flexDirection:\"column\",justifyContent:\"center\",alignItems:\"center\",padding:theme.spacing(2),\"& .MuiTextField-root\":{margin:theme.spacing(1),width:\"600px\"},\"& .MuiButtonBase-root\":{margin:theme.spacing(2)}}};});export default SigninForm;","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable/src/components/SigninForm.js"],"names":["React","useState","Button","TextField","makeStyles","useCustomToast","useEmployees","useRecoilState","loginLevelState","useEmployeesContext","App","SigninForm","classes","useStyles","toast","employees","email","setEmail","password","setPassword","role","setRole","loginLevel","setLoginLevel","setEditEmployeeID","handleLogin","event","preventDefault","auth","signInWithEmailAndPassword","update_login","title","status","emp","filter","item","map","row","id","name","leave_bal","siteallows_fee","perdiem_fee","reporting_to","length","loginUser","loginUserId","loginEmail","login","root","textAlign","width","e","target","value","button","theme","display","flexDirection","justifyContent","alignItems","padding","spacing","margin"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\n//import { useHistory } from \"react-router-dom\";\r\nimport { Button, TextField } from \"@material-ui/core\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { useCustomToast } from \"../helpers/useCustomToast\";\r\nimport { useEmployees } from \"./employees/useEmployees\";\r\nimport { useRecoilState } from \"recoil\";\r\nimport { loginLevelState } from \"./data/atomdata\";\r\nimport { useEmployeesContext } from \"../context/employees_context\";\r\n//import { setStoredUser } from \"./user-storage\";\r\n//import { useAuthContext } from \"../context/auth_context\";\r\nimport App from \"../utils/firebase\";\r\n\r\nconst SigninForm = () => {\r\n  //let history = useHistory();\r\n  const classes = useStyles();\r\n  const toast = useCustomToast();\r\n  //const { currentUser } = useAuthContext();\r\n  const { employees } = useEmployees();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [role, setRole] = useState(\"\");\r\n\r\n  const [loginLevel, setLoginLevel] = useRecoilState(loginLevelState);\r\n  const { setEditEmployeeID } = useEmployeesContext();\r\n\r\n  const handleLogin = async (event) => {\r\n    event.preventDefault();\r\n    //console.log(\"sigin\", email, password);\r\n    //const { email, password } = event.target.elements;\r\n    try {\r\n      await App.auth().signInWithEmailAndPassword(email, password);\r\n      //history.pushState(\"/\");\r\n      update_login();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Invalid email or password!\",\r\n        status: \"warning\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const update_login = () => {\r\n    const emp = employees\r\n      .filter((item) => item.email === email)\r\n      .map((row) => {\r\n        return {\r\n          id: row.id,\r\n          name: row.name,\r\n          email: row.email,\r\n          password: row.password,\r\n          role: role,\r\n          leave_bal: row.leave_bal,\r\n          siteallows_fee: row.siteallows_fee,\r\n          perdiem_fee: row.perdiem_fee,\r\n          reporting_to: row.reporting_to,\r\n        };\r\n      });\r\n\r\n    if (!emp.length) {\r\n      toast({\r\n        title: \"Invalid email!\",\r\n        status: \"warning\",\r\n      });\r\n    } else {\r\n      setLoginLevel({\r\n        ...loginLevel,\r\n        loginUser: emp[0].name,\r\n        loginUserId: emp[0].id,\r\n        loginLevel: role,\r\n        loginEmail: email,\r\n        login: true,\r\n        leave_bal: emp[0].leave_bal,\r\n        siteallows_fee: emp[0].siteallows_fee,\r\n        perdiem_fee: emp[0].perdiem_fee,\r\n        reporting_to: emp[0].reporting_to,\r\n      });\r\n      setEditEmployeeID(emp[0].id);\r\n      setPassword(\"\");\r\n      //setStoredUser(emp[0]);\r\n    }\r\n  };\r\n\r\n  // const handleStaffClick = (e) => {\r\n  //   console.log(\"Staff\");\r\n  //   e.preventDefault();\r\n  //   setRole(\"Staff\");\r\n  //   handleSubmit(e);\r\n  // };\r\n  // const handleAdminClick = (e) => {\r\n  //   e.preventDefault();\r\n  //   setRole(\"Admin\");\r\n  //   handleSubmit(e);\r\n  // };\r\n  // const handleAdminManagerClick = (e) => {\r\n  //   e.preventDefault();\r\n  //   setRole(\"AdminManager\");\r\n  //   handleSubmit(e);\r\n  // };\r\n  // const handleManagerClick = (e) => {\r\n  //   e.preventDefault();\r\n  //   setRole(\"Manager\");\r\n  //   // handleSubmit(e);\r\n  // };\r\n\r\n  return (\r\n    <form className={classes.root} onSubmit={handleLogin}>\r\n      <div style={{ textAlign: \"center\" }}>\r\n        <TextField\r\n          label=\"Email\"\r\n          variant=\"filled\"\r\n          type=\"email\"\r\n          required\r\n          style={{ width: 350 }}\r\n          value={email}\r\n          onChange={(e) => setEmail(e.target.value)}\r\n        />\r\n        <TextField\r\n          label=\"Password\"\r\n          variant=\"filled\"\r\n          type=\"password\"\r\n          style={{ width: 350 }}\r\n          required\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n        />\r\n      </div>\r\n\r\n      <div style={{ textAlign: \"center\" }}>\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"Staff\")}\r\n        >\r\n          Staff\r\n        </Button>\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"Admin\")}\r\n        >\r\n          Admin\r\n        </Button>\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"AdminManager\")}\r\n        >\r\n          Admin Manager\r\n        </Button>\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"Manager\")}\r\n        >\r\n          Manager\r\n        </Button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    padding: theme.spacing(2),\r\n\r\n    \"& .MuiTextField-root\": {\r\n      margin: theme.spacing(1),\r\n      width: \"600px\",\r\n    },\r\n    \"& .MuiButtonBase-root\": {\r\n      margin: theme.spacing(2),\r\n    },\r\n  },\r\n}));\r\n\r\nexport default SigninForm;\r\n"]},"metadata":{},"sourceType":"module"}