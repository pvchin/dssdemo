{"ast":null,"code":"import _objectSpread from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Button,Icon,TextField,Paper,Typography,Divider}from\"@material-ui/core\";import*as emailjs from\"emailjs-com\";import{useRecoilState}from\"recoil\";import{loginLevelState}from\"./data/atomdata\";import{makeStyles}from\"@material-ui/core/styles\";import{useCustomToast}from\"../helpers/useCustomToast\";import{useEmployees}from\"./employees/useEmployees\";import{useLeavesContext}from\"../context/leaves_context\";import{Controller,useForm}from\"react-hook-form\";import{useLeaves}from\"./leaves/useLeaves\";import{useAddLeaves}from\"./leaves/useAddLeaves\";import{useDeleteLeaves}from\"./leaves/useDeleteLeaves\";import{useUpdateLeaves}from\"./leaves/useUpdateLeaves\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SERVICE_ID=process.env.REACT_APP_EMAILJS_SERVICEID;var TEMPLATE_ID=\"template_1y8odlq\";var USER_ID=process.env.REACT_APP_EMAILJS_USERID;var initial_state={name:\"\",to_date:\"\",from_date:\"\",reason:\"\",status:\"Pending\",no_of_days:0,leave_bal:0};var LeaveForm=function LeaveForm(_ref){var formdata=_ref.formdata,setFormdata=_ref.setFormdata,handleDialogClose=_ref.handleDialogClose;var classes=useStyles();var toast=useCustomToast();var _useEmployees=useEmployees(),employees=_useEmployees.employees;var _useLeaves=useLeaves(),leaves=_useLeaves.leaves,filter=_useLeaves.filter,setFilter=_useLeaves.setFilter,setLeaveId=_useLeaves.setLeaveId;var updateLeaves=useUpdateLeaves();var addLeaves=useAddLeaves();var _useState=useState(initial_state),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useRecoilState=useRecoilState(loginLevelState),_useRecoilState2=_slicedToArray(_useRecoilState,2),loginLevel=_useRecoilState2[0],setLoginLevel=_useRecoilState2[1];var _useForm=useForm(),handleSubmit=_useForm.handleSubmit,control=_useForm.control;var initialValues=Object.values(initial_state).join(\"\");var _useLeavesContext=useLeavesContext(),isLeaveEditing=_useLeavesContext.isLeaveEditing,editLeaveID=_useLeavesContext.editLeaveID;var handleSentEmail=function handleSentEmail(data){var from_date=data.from_date,to_date=data.to_date;//console.log(\"leave form\", loginLevel);\nvar emaildata={to_name:loginLevel.loginUser,to_email:loginLevel.loginEmail,message:\"Your leave application from \".concat(from_date,\" to \").concat(to_date,\" has been successfully submitted for approval\"),cc_to:loginLevel.reporting_email};emailjs.send(SERVICE_ID,TEMPLATE_ID,emaildata,USER_ID).then(function(response){console.log(response.status,response.text);toast({title:\"Email has sent successfully to \".concat(emaildata.to_email,\"!\"),status:\"success\"});},function(err){console.log(err);toast({title:\"Email has fail to send to \".concat(emaildata.to_email,\"!\"),status:\"warning\"});});};var onSubmit=function onSubmit(data){console.log(\"leave\",data);if(isLeaveEditing){updateLeaves(_objectSpread({id:editLeaveID},data));}else{addLeaves(_objectSpread(_objectSpread({},data),{},{empid:loginLevel.loginUserId}));handleSentEmail(data);}//history.push(\"/leave\");\nhandleDialogClose();};// useEffect(() => {\n//   setState(initial_state);\n//   setState({ ...formdata });\n//   setState({ ...formdata });\n//   console.log(\"laeve form\",state)\n// }, [initialValues]);\nreturn/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Paper,{className:classes.root,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"h3\",children:\"LEAVE FORM\"}),/*#__PURE__*/_jsx(Typography,{component:\"p\",children:\"Leave Application\"}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"name\",control:control,defaultValue:loginLevel.loginUser,render:function render(_ref2){var _ref2$field=_ref2.field,_onChange=_ref2$field.onChange,value=_ref2$field.value,error=_ref2.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Name\",id:\"margin-normal\",name:\"name\"//value={value}\n,defaultValue:loginLevel.loginUser,className:classes.textField,onChange:function onChange(e){console.log(e.target.value);_onChange(e.target.value);},InputProps:{readOnly:true},error:!!error,helperText:error?error.message:null//select\n});}// rules={{ required: \"Name required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"from_date\",control:control,defaultValue:formdata.from_date,render:function render(_ref3){var _ref3$field=_ref3.field,onChange=_ref3$field.onChange,value=_ref3$field.value,error=_ref3.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"From Date\",type:\"date\",id:\"margin-normal\",name:\"from_date\",defaultValue:formdata.from_date,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null,InputLabelProps:{shrink:true}});},rules:{required:\"From Date is required\"}})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"to_date\",control:control,defaultValue:formdata.to_date,render:function render(_ref4){var _ref4$field=_ref4.field,onChange=_ref4$field.onChange,value=_ref4$field.value,error=_ref4.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"To Date\",id:\"margin-normal\",type:\"date\",name:\"to_date\",defaultValue:formdata.to_date,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null,InputLabelProps:{shrink:true}});},rules:{required:\"To Date is required\"}})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"leave_bal\",control:control,defaultValue:loginLevel.leave_bal,render:function render(_ref5){var _ref5$field=_ref5.field,_onChange2=_ref5$field.onChange,value=_ref5$field.value,error=_ref5.fieldState.error;return/*#__PURE__*/_jsx(TextField,{disable:true,label:\"Leave Balance\",type:\"number\",id:\"standard-number\",name:\"leave_bal\",defaultValue:loginLevel.leave_bal,className:classes.textField//onChange={onChange}\n,onChange:function onChange(e){_onChange2(parseInt(e.target.value,10));},error:!!error,helperText:error?error.message:null,InputProps:{readOnly:true}});}//rules={{ required: \"IC No required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"no_of_days\",control:control,defaultValue:formdata.no_of_days,render:function render(_ref6){var _ref6$field=_ref6.field,_onChange3=_ref6$field.onChange,value=_ref6$field.value,error=_ref6.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"No Of Days\",type:\"number\",id:\"standard-number\",name:\"no_of_days\",defaultValue:formdata.no_of_days,className:classes.textField//onChange={onChange}\n,onChange:function onChange(e){_onChange3(parseInt(e.target.value,10));},error:!!error,helperText:error?error.message:null});}//rules={{ required: \"IC No required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"reason\",control:control,defaultValue:formdata.reason,render:function render(_ref7){var _ref7$field=_ref7.field,onChange=_ref7$field.onChange,value=_ref7$field.value,error=_ref7.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Reason\",id:\"margin-normal\",name:\"reason\",defaultValue:formdata.reason,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null});}// rules={{ required: \"Reason is required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"status\",control:control,defaultValue:formdata.status,render:function render(_ref8){var _ref8$field=_ref8.field,onChange=_ref8$field.onChange,value=_ref8$field.value,error=_ref8.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Status\",id:\"margin-normal\",name:\"status\",defaultValue:formdata.status,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null,InputProps:{readOnly:true}// select\n});}//rules={{ required: \"Status is required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:handleSubmit(onSubmit),children:[\"Submit \",/*#__PURE__*/_jsx(Icon,{className:classes.rightIcon,children:\"send\"})]})})]})]})});};var useStyles=makeStyles(function(theme){return{button:{margin:theme.spacing(1)},leftIcon:{marginRight:theme.spacing(1)},rightIcon:{marginLeft:theme.spacing(1)},iconSmall:{fontSize:20},root:{padding:theme.spacing(3,2)},container:{display:\"flex\",flexWrap:\"wrap\"},textField:{marginLeft:theme.spacing(1),marginRight:theme.spacing(1),width:400}};});export default LeaveForm;","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable/src/components/LeaveForm.js"],"names":["React","useState","useEffect","Button","Icon","TextField","Paper","Typography","Divider","emailjs","useRecoilState","loginLevelState","makeStyles","useCustomToast","useEmployees","useLeavesContext","Controller","useForm","useLeaves","useAddLeaves","useDeleteLeaves","useUpdateLeaves","SERVICE_ID","process","env","REACT_APP_EMAILJS_SERVICEID","TEMPLATE_ID","USER_ID","REACT_APP_EMAILJS_USERID","initial_state","name","to_date","from_date","reason","status","no_of_days","leave_bal","LeaveForm","formdata","setFormdata","handleDialogClose","classes","useStyles","toast","employees","leaves","filter","setFilter","setLeaveId","updateLeaves","addLeaves","state","setState","loginLevel","setLoginLevel","handleSubmit","control","initialValues","Object","values","join","isLeaveEditing","editLeaveID","handleSentEmail","data","emaildata","to_name","loginUser","to_email","loginEmail","message","cc_to","reporting_email","send","then","response","console","log","text","title","err","onSubmit","id","empid","loginUserId","root","field","onChange","value","error","fieldState","textField","e","target","readOnly","shrink","required","parseInt","button","rightIcon","theme","margin","spacing","leftIcon","marginRight","marginLeft","iconSmall","fontSize","padding","container","display","flexWrap","width"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Button,\r\n  Icon,\r\n  TextField,\r\n  Paper,\r\n  Typography,\r\n  Divider,\r\n} from \"@material-ui/core\";\r\nimport * as emailjs from \"emailjs-com\";\r\nimport { useRecoilState } from \"recoil\";\r\nimport { loginLevelState } from \"./data/atomdata\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { useCustomToast } from \"../helpers/useCustomToast\";\r\nimport { useEmployees } from \"./employees/useEmployees\";\r\nimport { useLeavesContext } from \"../context/leaves_context\";\r\nimport { Controller, useForm } from \"react-hook-form\";\r\nimport { useLeaves } from \"./leaves/useLeaves\";\r\nimport { useAddLeaves } from \"./leaves/useAddLeaves\";\r\nimport { useDeleteLeaves } from \"./leaves/useDeleteLeaves\";\r\nimport { useUpdateLeaves } from \"./leaves/useUpdateLeaves\";\r\n\r\nconst SERVICE_ID = process.env.REACT_APP_EMAILJS_SERVICEID;\r\nconst TEMPLATE_ID = \"template_1y8odlq\";\r\nconst USER_ID = process.env.REACT_APP_EMAILJS_USERID;\r\n\r\nconst initial_state = {\r\n  name: \"\",\r\n  to_date: \"\",\r\n  from_date: \"\",\r\n  reason: \"\",\r\n  status: \"Pending\",\r\n  no_of_days: 0,\r\n  leave_bal: 0,\r\n};\r\n\r\nconst LeaveForm = ({ formdata, setFormdata, handleDialogClose }) => {\r\n  const classes = useStyles();\r\n  const toast = useCustomToast();\r\n  const { employees } = useEmployees();\r\n  const { leaves, filter, setFilter, setLeaveId } = useLeaves();\r\n  const updateLeaves = useUpdateLeaves();\r\n  const addLeaves = useAddLeaves();\r\n  const [state, setState] = useState(initial_state);\r\n  const [loginLevel, setLoginLevel] = useRecoilState(loginLevelState);\r\n  const { handleSubmit, control } = useForm();\r\n  const initialValues = Object.values(initial_state).join(\"\");\r\n  const { isLeaveEditing, editLeaveID } = useLeavesContext();\r\n\r\n  const handleSentEmail = (data) => {\r\n    const { from_date, to_date } = data;\r\n    //console.log(\"leave form\", loginLevel);\r\n    var emaildata = {\r\n      to_name: loginLevel.loginUser,\r\n      to_email: loginLevel.loginEmail,\r\n      message: `Your leave application from ${from_date} to ${to_date} has been successfully submitted for approval`,\r\n      cc_to: loginLevel.reporting_email,\r\n    };\r\n\r\n    emailjs.send(SERVICE_ID, TEMPLATE_ID, emaildata, USER_ID).then(\r\n      function (response) {\r\n        console.log(response.status, response.text);\r\n        toast({\r\n          title: `Email has sent successfully to ${emaildata.to_email}!`,\r\n          status: \"success\",\r\n        });\r\n      },\r\n      function (err) {\r\n        console.log(err);\r\n        toast({\r\n          title: `Email has fail to send to ${emaildata.to_email}!`,\r\n          status: \"warning\",\r\n        });\r\n      }\r\n    );\r\n  };\r\n\r\n  const onSubmit = (data) => {\r\n    console.log(\"leave\", data);\r\n    if (isLeaveEditing) {\r\n      updateLeaves({ id: editLeaveID, ...data });\r\n    } else {\r\n      addLeaves({ ...data, empid: loginLevel.loginUserId });\r\n      handleSentEmail(data);\r\n    }\r\n\r\n    //history.push(\"/leave\");\r\n    handleDialogClose();\r\n  };\r\n\r\n  // useEffect(() => {\r\n  //   setState(initial_state);\r\n  //   setState({ ...formdata });\r\n  //   setState({ ...formdata });\r\n  //   console.log(\"laeve form\",state)\r\n  // }, [initialValues]);\r\n\r\n  return (\r\n    <div>\r\n      <Paper className={classes.root}>\r\n        <Typography variant=\"h5\" component=\"h3\">\r\n          LEAVE FORM\r\n        </Typography>\r\n        <Typography component=\"p\">Leave Application</Typography>\r\n        <Divider />\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <div>\r\n            <Controller\r\n              name=\"name\"\r\n              control={control}\r\n              defaultValue={loginLevel.loginUser}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Name\"\r\n                    id=\"margin-normal\"\r\n                    name=\"name\"\r\n                    //value={value}\r\n                    defaultValue={loginLevel.loginUser}\r\n                    className={classes.textField}\r\n                    onChange={(e) => {\r\n                      console.log(e.target.value);\r\n                      onChange(e.target.value);\r\n                    }}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                    }}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    //select\r\n                  >\r\n                    {/* {employees.map((e) => {\r\n                      return (\r\n                        <MenuItem key={e.name} value={e.name}>\r\n                          {e.name}\r\n                        </MenuItem>\r\n                      );\r\n                    })} */}\r\n                  </TextField>\r\n                );\r\n              }}\r\n              // rules={{ required: \"Name required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"from_date\"\r\n              control={control}\r\n              defaultValue={formdata.from_date}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"From Date\"\r\n                    type=\"date\"\r\n                    id=\"margin-normal\"\r\n                    name=\"from_date\"\r\n                    defaultValue={formdata.from_date}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    InputLabelProps={{\r\n                      shrink: true,\r\n                    }}\r\n                  />\r\n                );\r\n              }}\r\n              rules={{ required: \"From Date is required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"to_date\"\r\n              control={control}\r\n              defaultValue={formdata.to_date}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"To Date\"\r\n                    id=\"margin-normal\"\r\n                    type=\"date\"\r\n                    name=\"to_date\"\r\n                    defaultValue={formdata.to_date}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    InputLabelProps={{\r\n                      shrink: true,\r\n                    }}\r\n                  />\r\n                );\r\n              }}\r\n              rules={{ required: \"To Date is required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"leave_bal\"\r\n              control={control}\r\n              defaultValue={loginLevel.leave_bal}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    disable\r\n                    label=\"Leave Balance\"\r\n                    type=\"number\"\r\n                    id=\"standard-number\"\r\n                    name=\"leave_bal\"\r\n                    defaultValue={loginLevel.leave_bal}\r\n                    className={classes.textField}\r\n                    //onChange={onChange}\r\n                    onChange={(e) => {\r\n                      onChange(parseInt(e.target.value, 10));\r\n                    }}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                    }}\r\n                  />\r\n                );\r\n              }}\r\n              //rules={{ required: \"IC No required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"no_of_days\"\r\n              control={control}\r\n              defaultValue={formdata.no_of_days}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"No Of Days\"\r\n                    type=\"number\"\r\n                    id=\"standard-number\"\r\n                    name=\"no_of_days\"\r\n                    defaultValue={formdata.no_of_days}\r\n                    className={classes.textField}\r\n                    //onChange={onChange}\r\n                    onChange={(e) => {\r\n                      onChange(parseInt(e.target.value, 10));\r\n                    }}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                  />\r\n                );\r\n              }}\r\n              //rules={{ required: \"IC No required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"reason\"\r\n              control={control}\r\n              defaultValue={formdata.reason}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Reason\"\r\n                    id=\"margin-normal\"\r\n                    name=\"reason\"\r\n                    defaultValue={formdata.reason}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                  />\r\n                );\r\n              }}\r\n              // rules={{ required: \"Reason is required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"status\"\r\n              control={control}\r\n              defaultValue={formdata.status}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Status\"\r\n                    id=\"margin-normal\"\r\n                    name=\"status\"\r\n                    defaultValue={formdata.status}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                    }}\r\n                    // select\r\n                  >\r\n                    {/* <MenuItem value=\"Pending\">Pending</MenuItem>\r\n                    <MenuItem value=\"Cancel\">Cancel</MenuItem>\r\n                    <MenuItem value=\"Approve\">Approve</MenuItem>\r\n                    <MenuItem value=\"Reject\">Reject</MenuItem> */}\r\n                  </TextField>\r\n                );\r\n              }}\r\n              //rules={{ required: \"Status is required\" }}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <Button\r\n              type=\"submit\"\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              className={classes.button}\r\n              onClick={handleSubmit(onSubmit)}\r\n            >\r\n              Submit <Icon className={classes.rightIcon}>send</Icon>\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </Paper>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  rightIcon: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n  iconSmall: {\r\n    fontSize: 20,\r\n  },\r\n  root: {\r\n    padding: theme.spacing(3, 2),\r\n  },\r\n  container: {\r\n    display: \"flex\",\r\n    flexWrap: \"wrap\",\r\n  },\r\n  textField: {\r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1),\r\n    width: 400,\r\n  },\r\n}));\r\n\r\nexport default LeaveForm;\r\n"]},"metadata":{},"sourceType":"module"}