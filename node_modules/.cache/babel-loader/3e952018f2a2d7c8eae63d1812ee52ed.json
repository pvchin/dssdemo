{"ast":null,"code":"import _objectSpread from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import{Button,Icon,TextField,Paper,Typography}from\"@material-ui/core\";import{makeStyles}from\"@material-ui/core/styles\";import{useRecoilState}from\"recoil\";import*as emailjs from\"emailjs-com\";import{loginLevelState}from\"./data/atomdata\";import MenuItem from\"@material-ui/core/MenuItem\";import{useEmployeesContext}from\"../context/employees_context\";import{useExpensesContext}from\"../context/expenses_context\";import{Controller,useForm}from\"react-hook-form\";import{useCustomToast}from\"../helpers/useCustomToast\";import{useExpenses}from\"./expenses/useExpenses\";import{useAddExpenses}from\"./expenses/useAddExpenses\";import{useDeleteExpenses}from\"./expenses/useDeleteExpenses\";import{useUpdateExpenses}from\"./expenses/useUpdateExpenses\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SERVICE_ID=process.env.REACT_APP_EMAILJS_SERVICEID;var TEMPLATE_ID=\"template_1y8odlq\";var USER_ID=process.env.REACT_APP_EMAILJS_USERID;var initial_values={name:\"\",date:\"\",purchased_date:\"\",purchased_from:\"\",description:\"\",remark:\"\",status:\"Pending\",amount:0};var ExpenseForm=function ExpenseForm(_ref){var formdata=_ref.formdata,setFormdata=_ref.setFormdata,handleDialogClose=_ref.handleDialogClose;var classes=useStyles();var toast=useCustomToast();var _useExpenses=useExpenses(),expenses=_useExpenses.expenses,filter=_useExpenses.filter,setFilter=_useExpenses.setFilter,setExpenseId=_useExpenses.setExpenseId;var updateExpenses=useUpdateExpenses();var addExpenses=useAddExpenses();var _useRecoilState=useRecoilState(loginLevelState),_useRecoilState2=_slicedToArray(_useRecoilState,2),loginLevel=_useRecoilState2[0],setLoginLevel=_useRecoilState2[1];var _useExpensesContext=useExpensesContext(),isExpenseEditing=_useExpensesContext.isExpenseEditing,editExpenseID=_useExpensesContext.editExpenseID;var _useForm=useForm(),handleSubmit=_useForm.handleSubmit,control=_useForm.control;var handleSentEmail=function handleSentEmail(data){var date=data.date;//console.log(\"expense form\", loginLevel);\nvar emaildata={to_name:loginLevel.loginUser,to_email:loginLevel.loginEmail,message:\"Your expenses claim application dated on \".concat(date,\" has been successfully submitted for approval\"),cc_to:loginLevel.reporting_email};emailjs.send(SERVICE_ID,TEMPLATE_ID,emaildata,USER_ID).then(function(response){console.log(response.status,response.text);toast({title:\"Email has sent successfully to \".concat(emaildata.to_email,\"!\"),status:\"success\"});},function(err){console.log(err);toast({title:\"Email has fail to send to \".concat(emaildata.to_email,\"!\"),status:\"warning\"});});};var onSubmit=function onSubmit(data,e){e.preventDefault();if(isExpenseEditing){updateExpenses(_objectSpread({id:editExpenseID},data));}else{addExpenses(_objectSpread({empid:loginLevel.loginUserId},data));handleSentEmail(data);}handleDialogClose();};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Paper,{className:classes.root,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"h3\",children:\"EXPENSES CLAIM FORM\"}),/*#__PURE__*/_jsx(Typography,{component:\"p\",children:\"Expense Claim Application\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"name\",control:control,defaultValue:loginLevel.loginUser,render:function render(_ref2){var _ref2$field=_ref2.field,onChange=_ref2$field.onChange,value=_ref2$field.value,error=_ref2.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Name\",id:\"margin-normal1\",name:\"name\",defaultValue:loginLevel.loginUser,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null,InputProps:{readOnly:true}});}})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"date\",control:control,defaultValue:formdata.date,render:function render(_ref3){var _ref3$field=_ref3.field,onChange=_ref3$field.onChange,value=_ref3$field.value,error=_ref3.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Date\",type:\"date\",id:\"margin-normal2\",name:\"formdata.date\",value:value,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null,InputLabelProps:{shrink:true}});},rules:{required:\"From Date is required\"}})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"purchased_from\",control:control,defaultValue:formdata.purchased_from,render:function render(_ref4){var _ref4$field=_ref4.field,onChange=_ref4$field.onChange,value=_ref4$field.value,error=_ref4.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Purchased From\",id:\"margin-normal3\",name:\"purchased_from\",defaultValue:formdata.purchased_from,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null});}// rules={{ required: \"Reason is required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"description\",control:control,defaultValue:formdata.description,render:function render(_ref5){var _ref5$field=_ref5.field,onChange=_ref5$field.onChange,value=_ref5$field.value,error=_ref5.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Description\",id:\"margin-normal4\",name:\"description\",defaultValue:formdata.description,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null});}// rules={{ required: \"Reason is required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"amount\",control:control,defaultValue:formdata.amount,render:function render(_ref6){var _ref6$field=_ref6.field,_onChange=_ref6$field.onChange,value=_ref6$field.value,error=_ref6.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Amount\",type:\"number\",id:\"standard-number1\",name:\"amount\",defaultValue:formdata.amount,className:classes.textField//onChange={onChange}\n,onChange:function onChange(e){_onChange(parseInt(e.target.value,10));},error:!!error,helperText:error?error.message:null});}//rules={{ required: \"IC No required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"remark\",control:control,defaultValue:formdata.remark,render:function render(_ref7){var _ref7$field=_ref7.field,onChange=_ref7$field.onChange,value=_ref7$field.value,error=_ref7.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Remark\",id:\"margin-normal5\",name:\"remark\",defaultValue:formdata.remark,className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null});}// rules={{ required: \"Reason is required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"status\",control:control,defaultValue:\"Pending\",render:function render(_ref8){var _ref8$field=_ref8.field,onChange=_ref8$field.onChange,value=_ref8$field.value,error=_ref8.fieldState.error;return/*#__PURE__*/_jsx(TextField,{label:\"Status\",id:\"margin-normal6\",name:\"status\",defaultValue:\"Pending\",className:classes.textField,onChange:onChange,error:!!error,helperText:error?error.message:null,InputProps:{readOnly:true}});}//rules={{ required: \"Status is required\" }}\n})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button//onClick={() => handleSubmit(onSubmit)()}\n,children:[\"Save \",/*#__PURE__*/_jsx(Icon,{className:classes.rightIcon,children:\"send\"})]})})]})]})});};var useStyles=makeStyles(function(theme){return{button:{margin:theme.spacing(1)},leftIcon:{marginRight:theme.spacing(1)},rightIcon:{marginLeft:theme.spacing(1)},iconSmall:{fontSize:20},root:{padding:theme.spacing(3,2)},container:{display:\"flex\",flexWrap:\"wrap\"},textField:{marginLeft:theme.spacing(1),marginRight:theme.spacing(1),width:400}};});export default ExpenseForm;","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable/src/components/ExpenseForm.js"],"names":["React","Button","Icon","TextField","Paper","Typography","makeStyles","useRecoilState","emailjs","loginLevelState","MenuItem","useEmployeesContext","useExpensesContext","Controller","useForm","useCustomToast","useExpenses","useAddExpenses","useDeleteExpenses","useUpdateExpenses","SERVICE_ID","process","env","REACT_APP_EMAILJS_SERVICEID","TEMPLATE_ID","USER_ID","REACT_APP_EMAILJS_USERID","initial_values","name","date","purchased_date","purchased_from","description","remark","status","amount","ExpenseForm","formdata","setFormdata","handleDialogClose","classes","useStyles","toast","expenses","filter","setFilter","setExpenseId","updateExpenses","addExpenses","loginLevel","setLoginLevel","isExpenseEditing","editExpenseID","handleSubmit","control","handleSentEmail","data","emaildata","to_name","loginUser","to_email","loginEmail","message","cc_to","reporting_email","send","then","response","console","log","text","title","err","onSubmit","e","preventDefault","id","empid","loginUserId","root","field","onChange","value","error","fieldState","textField","readOnly","shrink","required","parseInt","target","button","rightIcon","theme","margin","spacing","leftIcon","marginRight","marginLeft","iconSmall","fontSize","padding","container","display","flexWrap","width"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Button, Icon, TextField, Paper, Typography } from \"@material-ui/core\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { useRecoilState } from \"recoil\";\r\nimport * as emailjs from \"emailjs-com\";\r\nimport { loginLevelState } from \"./data/atomdata\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport { useEmployeesContext } from \"../context/employees_context\";\r\nimport { useExpensesContext } from \"../context/expenses_context\";\r\nimport { Controller, useForm } from \"react-hook-form\";\r\nimport { useCustomToast } from \"../helpers/useCustomToast\";\r\nimport { useExpenses } from \"./expenses/useExpenses\";\r\nimport { useAddExpenses } from \"./expenses/useAddExpenses\";\r\nimport { useDeleteExpenses } from \"./expenses/useDeleteExpenses\";\r\nimport { useUpdateExpenses } from \"./expenses/useUpdateExpenses\";\r\n\r\nconst SERVICE_ID = process.env.REACT_APP_EMAILJS_SERVICEID;\r\nconst TEMPLATE_ID = \"template_1y8odlq\";\r\nconst USER_ID = process.env.REACT_APP_EMAILJS_USERID;\r\n\r\nconst initial_values = {\r\n  name: \"\",\r\n  date: \"\",\r\n  purchased_date: \"\",\r\n  purchased_from: \"\",\r\n  description: \"\",\r\n  remark: \"\",\r\n  status: \"Pending\",\r\n  amount: 0,\r\n};\r\n\r\nconst ExpenseForm = ({ formdata, setFormdata, handleDialogClose }) => {\r\n  const classes = useStyles();\r\n  const toast = useCustomToast();\r\n  const { expenses, filter, setFilter, setExpenseId } = useExpenses();\r\n  const updateExpenses = useUpdateExpenses();\r\n  const addExpenses = useAddExpenses();\r\n  const [loginLevel, setLoginLevel] = useRecoilState(loginLevelState);\r\n  const { isExpenseEditing, editExpenseID } = useExpensesContext();\r\n\r\n  const { handleSubmit, control } = useForm();\r\n\r\n  const handleSentEmail = (data) => {\r\n    const { date } = data;\r\n    //console.log(\"expense form\", loginLevel);\r\n    var emaildata = {\r\n      to_name: loginLevel.loginUser,\r\n      to_email: loginLevel.loginEmail,\r\n      message: `Your expenses claim application dated on ${date} has been successfully submitted for approval`,\r\n      cc_to: loginLevel.reporting_email,\r\n    };\r\n\r\n    emailjs.send(SERVICE_ID, TEMPLATE_ID, emaildata, USER_ID).then(\r\n      function (response) {\r\n        console.log(response.status, response.text);\r\n        toast({\r\n          title: `Email has sent successfully to ${emaildata.to_email}!`,\r\n          status: \"success\",\r\n        });\r\n      },\r\n      function (err) {\r\n        console.log(err);\r\n        toast({\r\n          title: `Email has fail to send to ${emaildata.to_email}!`,\r\n          status: \"warning\",\r\n        });\r\n      }\r\n    );\r\n  };\r\n\r\n  const onSubmit = (data, e) => {\r\n    e.preventDefault();\r\n    if (isExpenseEditing) {\r\n      updateExpenses({ id: editExpenseID, ...data });\r\n    } else {\r\n      addExpenses({ empid: loginLevel.loginUserId, ...data });\r\n      handleSentEmail(data);\r\n    }\r\n\r\n    handleDialogClose();\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Paper className={classes.root}>\r\n        <Typography variant=\"h5\" component=\"h3\">\r\n          EXPENSES CLAIM FORM\r\n        </Typography>\r\n        <Typography component=\"p\">Expense Claim Application</Typography>\r\n\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <div>\r\n            <Controller\r\n              name=\"name\"\r\n              control={control}\r\n              defaultValue={loginLevel.loginUser}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Name\"\r\n                    id=\"margin-normal1\"\r\n                    name=\"name\"\r\n                    defaultValue={loginLevel.loginUser}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                    }}\r\n                  ></TextField>\r\n                );\r\n              }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"date\"\r\n              control={control}\r\n              defaultValue={formdata.date}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Date\"\r\n                    type=\"date\"\r\n                    id=\"margin-normal2\"\r\n                    name=\"formdata.date\"\r\n                    value={value}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    InputLabelProps={{\r\n                      shrink: true,\r\n                    }}\r\n                  />\r\n                );\r\n              }}\r\n              rules={{ required: \"From Date is required\" }}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <Controller\r\n              name=\"purchased_from\"\r\n              control={control}\r\n              defaultValue={formdata.purchased_from}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Purchased From\"\r\n                    id=\"margin-normal3\"\r\n                    name=\"purchased_from\"\r\n                    defaultValue={formdata.purchased_from}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                  />\r\n                );\r\n              }}\r\n              // rules={{ required: \"Reason is required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"description\"\r\n              control={control}\r\n              defaultValue={formdata.description}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Description\"\r\n                    id=\"margin-normal4\"\r\n                    name=\"description\"\r\n                    defaultValue={formdata.description}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                  />\r\n                );\r\n              }}\r\n              // rules={{ required: \"Reason is required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"amount\"\r\n              control={control}\r\n              defaultValue={formdata.amount}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Amount\"\r\n                    type=\"number\"\r\n                    id=\"standard-number1\"\r\n                    name=\"amount\"\r\n                    defaultValue={formdata.amount}\r\n                    className={classes.textField}\r\n                    //onChange={onChange}\r\n                    onChange={(e) => {\r\n                      onChange(parseInt(e.target.value, 10));\r\n                    }}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                  />\r\n                );\r\n              }}\r\n              //rules={{ required: \"IC No required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"remark\"\r\n              control={control}\r\n              defaultValue={formdata.remark}\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Remark\"\r\n                    id=\"margin-normal5\"\r\n                    name=\"remark\"\r\n                    defaultValue={formdata.remark}\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                  />\r\n                );\r\n              }}\r\n              // rules={{ required: \"Reason is required\" }}\r\n            />\r\n          </div>\r\n          <div>\r\n            <Controller\r\n              name=\"status\"\r\n              control={control}\r\n              defaultValue=\"Pending\"\r\n              render={({\r\n                field: { onChange, value },\r\n                fieldState: { error },\r\n              }) => {\r\n                return (\r\n                  <TextField\r\n                    label=\"Status\"\r\n                    id=\"margin-normal6\"\r\n                    name=\"status\"\r\n                    defaultValue=\"Pending\"\r\n                    className={classes.textField}\r\n                    onChange={onChange}\r\n                    error={!!error}\r\n                    helperText={error ? error.message : null}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                    }}\r\n                  ></TextField>\r\n                );\r\n              }}\r\n              //rules={{ required: \"Status is required\" }}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <Button\r\n              type=\"submit\"\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              className={classes.button}\r\n              //onClick={() => handleSubmit(onSubmit)()}\r\n            >\r\n              Save <Icon className={classes.rightIcon}>send</Icon>\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </Paper>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  rightIcon: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n  iconSmall: {\r\n    fontSize: 20,\r\n  },\r\n  root: {\r\n    padding: theme.spacing(3, 2),\r\n  },\r\n  container: {\r\n    display: \"flex\",\r\n    flexWrap: \"wrap\",\r\n  },\r\n  textField: {\r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1),\r\n    width: 400,\r\n  },\r\n}));\r\n\r\nexport default ExpenseForm;\r\n"]},"metadata":{},"sourceType":"module"}